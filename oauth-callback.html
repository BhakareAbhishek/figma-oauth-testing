<!DOCTYPE html>
<html>
<head>
  <title>GitHub OAuth Callback</title>
</head>
<body>
  <script>
    (function () {
      const url = new URL(window.location.href);
      const code = url.searchParams.get('code');
      const state = url.searchParams.get('state');

      console.log('‚úÖ Code:', code);
      console.log('üîê State:', state);

      if (window.opener) {
        window.opener.postMessage(
          { type: 'github-code', code, state },
          '*' // allow all origins
        );
        window.close(); // Close the popup
      } else {
        console.warn('window.opener is null');
        document.body.innerHTML += '<p>Could not communicate with plugin.</p>';
      }
    })();
  </script>
</body>
</html>
